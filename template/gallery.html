<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <title>IAmodel</title>
</head>
<body> 
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
        .margin {
            margin-top: 10px;
        }

        .marginX {
            margin-top: 30px;
        }
    </style>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Bienvenido {{ session['usuario'] }}</a>
            <form class="d-flex" action="/logout" method="post">
                <button class="btn btn-outline-danger" type="submit">Cerrar Sesión</button>
            </form>
        </div>
    </nav>

    <div class="container text-center marginX">
        <div class="row">
          <div class="col">
            <div id="imagePreview"></div>
            <form id="uploadForm" action="/upload" method="post" enctype="multipart/form-data">
                <input type="file" id="fileInput" name="file" accept="image/*">
                <input class="btn btn-primary" type="submit" value="upload">
            </form>
          </div>
          <div class="col">
            <ul class="list-group">
                <li class="list-group-item">An item</li>
                <li class="list-group-item">A second item</li>
                <li class="list-group-item">A third item</li>
                <li class="list-group-item">A fourth item</li>
                <li class="list-group-item">And a fifth one</li>
            </ul>
          </div>
        </div>
    </div>

    <h3 style="text-align: center;">Galeria</h3>
    {% if images %}
        <div class="container text-center">
            <div class="row row-cols-4">
                {% for image in images %}
                    <div class="col margin">
                        <img class="img-fluid" src="https://th.bing.com/th/id/OIP.4LrWM2SoZ_6mUiEsJUv4aQAAAA?rs=1&pid=ImgDetMain" alt="{{ image.nombre }}">
                        <form action="{{ url_for('delete_image', idImagen=image.idImagen) }}" method="post">
                            <div class="btn-group margin" role="group" aria-label="Basic mixed styles example">
                                <button class="btn btn-outline-danger" type="submit">Eliminar</button>
                                <button class="btn btn-outline-primary" type="submit">Analizar</button>
                            </div>
                        </form>
                    </div>
                {% endfor %}
        </div>
    {% else %}
        <p>No hay imagenes para mostrar.</p>
    {% endif %}

   <script>
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById('fileInput').addEventListener('change', function() {
                var file = this.files[0];
                if (file) {
                    var reader = new FileReader();
                    reader.onload = function(event) {
                        var imagePreview = document.getElementById('imagePreview');
                        imagePreview.innerHTML = '';
                        var img = document.createElement('img');
                        img.src = event.target.result;
                        img.style.maxWidth = '100%'; // Ajusta el tamaño de la imagen previa
                        imagePreview.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                }
            });
        });
   </script> 
</body>
</html>